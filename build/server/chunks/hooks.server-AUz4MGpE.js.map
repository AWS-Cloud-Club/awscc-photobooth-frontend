{"version":3,"file":"hooks.server-AUz4MGpE.js","sources":["../../../.svelte-kit/adapter-node/chunks/hooks.server.js"],"sourcesContent":["import { r as redirect } from \"./index.js\";\nimport { t as themes } from \"./index3.js\";\nconst handle = async ({ resolve, event }) => {\n  event.locals.message = \"AWSCC-PUP Photobooth is now running...\";\n  console.log(event.locals.message);\n  if (event.url.pathname.startsWith(\"/api\")) {\n    if (event.request.method === \"OPTIONS\") {\n      return new Response(null, {\n        headers: {\n          \"Access-Control-Allow-Methods\": \"GET, POST, PUT, DELETE, PATCH, OPTIONS\",\n          \"Access-Control-Allow-Origin\": \"*\",\n          \"Access-Control-Allow-Headers\": \"*\"\n        }\n      });\n    }\n  }\n  const theme = event.cookies.get(\"theme\");\n  const token = event.cookies.get(\"token\");\n  if (token !== void 0) {\n    event.locals.authenticated = true;\n  } else {\n    event.locals.authenticated = false;\n  }\n  if (event.url.pathname.startsWith(\"/admin\") && !event.locals.authenticated) {\n    throw redirect(303, \"/login\");\n  }\n  if (!theme || !themes.includes(theme)) {\n    const response2 = await resolve(event);\n    if (event.url.pathname.startsWith(\"/api\")) {\n      response2.headers.append(\"Access-Control-Allow-Origin\", `*`);\n    }\n    return response2;\n  }\n  const response = await resolve(event, {\n    transformPageChunk: ({ html }) => {\n      return html.replace('data-theme=\"\"', `data-theme=\"${theme}\"`);\n    }\n  });\n  if (event.url.pathname.startsWith(\"/api\")) {\n    const newHeaders = new Headers(response.headers);\n    newHeaders.append(\"Access-Control-Allow-Origin\", \"*\");\n    return new Response(response.body, {\n      status: response.status,\n      statusText: response.statusText,\n      headers: newHeaders\n    });\n  }\n  return response;\n};\nexport {\n  handle\n};\n"],"names":[],"mappings":";;;AAEK,MAAC,MAAM,GAAG,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK;AAC7C,EAAE,KAAK,CAAC,MAAM,CAAC,OAAO,GAAG,wCAAwC,CAAC;AAClE,EAAE,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;AACpC,EAAE,IAAI,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;AAC7C,IAAI,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,KAAK,SAAS,EAAE;AAC5C,MAAM,OAAO,IAAI,QAAQ,CAAC,IAAI,EAAE;AAChC,QAAQ,OAAO,EAAE;AACjB,UAAU,8BAA8B,EAAE,wCAAwC;AAClF,UAAU,6BAA6B,EAAE,GAAG;AAC5C,UAAU,8BAA8B,EAAE,GAAG;AAC7C,SAAS;AACT,OAAO,CAAC,CAAC;AACT,KAAK;AACL,GAAG;AACH,EAAE,MAAM,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;AAC3C,EAAE,MAAM,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;AAC3C,EAAE,IAAI,KAAK,KAAK,KAAK,CAAC,EAAE;AACxB,IAAI,KAAK,CAAC,MAAM,CAAC,aAAa,GAAG,IAAI,CAAC;AACtC,GAAG,MAAM;AACT,IAAI,KAAK,CAAC,MAAM,CAAC,aAAa,GAAG,KAAK,CAAC;AACvC,GAAG;AACH,EAAE,IAAI,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,aAAa,EAAE;AAC9E,IAAI,MAAM,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;AAClC,GAAG;AACH,EAAE,IAAI,CAAC,KAAK,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;AACzC,IAAI,MAAM,SAAS,GAAG,MAAM,OAAO,CAAC,KAAK,CAAC,CAAC;AAC3C,IAAI,IAAI,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;AAC/C,MAAM,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,6BAA6B,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;AACnE,KAAK;AACL,IAAI,OAAO,SAAS,CAAC;AACrB,GAAG;AACH,EAAE,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,KAAK,EAAE;AACxC,IAAI,kBAAkB,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK;AACtC,MAAM,OAAO,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;AACpE,KAAK;AACL,GAAG,CAAC,CAAC;AACL,EAAE,IAAI,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;AAC7C,IAAI,MAAM,UAAU,GAAG,IAAI,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;AACrD,IAAI,UAAU,CAAC,MAAM,CAAC,6BAA6B,EAAE,GAAG,CAAC,CAAC;AAC1D,IAAI,OAAO,IAAI,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE;AACvC,MAAM,MAAM,EAAE,QAAQ,CAAC,MAAM;AAC7B,MAAM,UAAU,EAAE,QAAQ,CAAC,UAAU;AACrC,MAAM,OAAO,EAAE,UAAU;AACzB,KAAK,CAAC,CAAC;AACP,GAAG;AACH,EAAE,OAAO,QAAQ,CAAC;AAClB;;;;"}